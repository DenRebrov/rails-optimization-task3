# Case-study оптимизации

## Актуальная проблема
В нашем проекте возникли следующие проблемы:
* Долгий импорт данных в БД
* Долгий рендеринг страницы расписаний

## Формирование метрики
Для того, чтобы понимать, дают ли мои изменения положительный эффект на быстродействие программы я придумал использовать такую метрику:
* Бюджет загрузки файла c 1K трипов (fixtures/small.json) - 7.5 сек. (23 сек.)
* Бюджет загрузки файла со 100К трипов (fixtures/large.json) - 60 сек. (to match...)

## Гарантия корректности работы оптимизированной программы
Тест корректности загрузки данных `spec/json_loader_spec.rb`. Выполнение этого теста в фидбек-лупе позволяет не допустить изменения логики программы при оптимизации.

## Feedback-Loop
Для того, чтобы иметь возможность быстро проверять гипотезы я выстроил эффективный `feedback-loop`

Вот как я построил `feedback_loop`:
- анализ отчетов
- изменения в программе
- замер метрики
- запуск теста

## Вникаем в детали системы, чтобы найти главные точки роста
Для того, чтобы найти "точки роста" для оптимизации я воспользовался:
- rack-mini-profiler
- bullet

Вот какие проблемы удалось найти и решить:

### Итерация №1
- Загрузка данных с помощью activerecord-import gem
    * Loading data from fixtures/small.json - 23.2 сек -> 7.5 сек
    * Loading data from fixtures/large.json - 58.31 сек (в рамках бюджета).